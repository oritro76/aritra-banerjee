# Automated tests for Best Buy API Playground

**Requirements**
Python 3.8, NodeJs

For developing the test framework Python + pytest + request + Allure Reports + loguru are used

## Prerequisites
Install Allure Reports from https://docs.qameta.io/allure/#_installing_a_commandline

## Solution Explained

The test cases are categorized into two parts. Smoke tests and End-to-End tests. 
After a deployment, first the Smoke tests will run. Smoke tests will ensure the 
testability of the deployed changes. If all the Smoke tests pass then End-to-End tests 
will run to validate all the existing features of the APIs.  

## Project Organization
```
|-- clients
|   |-- api_playground_client.py <- functions for making http Best Buy API calls         
|   |-- http_client.py           <- functions for making http API calls
|   `-- __init__.py
|-- conf
|   |-- conf.py                  <- settings and configurations for the project  
|   `-- __init__.py
|-- data
|   |-- data_gen.py              <- functions to generate data for API testing
|   `-- __init__.py
|-- logs                         <- folder for log files
|-- response_json_schema
|   |-- api_schema.py            <- schema for validation
|   `-- __init__.py
|-- test
|   |-- conftest.py              <- pytest fixtures
|   |-- __init__.py
|   |-- test_category_apis.py    <- tests for category APIs   
|   |-- test_product_apis.py     <- tests for product APIs
|   |-- test_service_apis.py     <- tests for service APIs
|   |-- test_store_apis.py       <- tests for store APIs
|   `-- test_utility_apis.py     <- tests for utility APIs
|-- test_results                 <- test resuls generated by Allure Reports 
|-- utils
|   |-- functions.py             <- helper functions 
|   `-- __init__.py
|-- conftest.py                  <- pytest fixtures
|-- pytest.ini                   <- pytest configurations 
|-- README.md                    <- The top-level README for developers using this project.
`-- requirements.txt             <- The requirements file for python environment
```

## Test Cases

> API endpoints:
> * /products [GET, POST, PATCH, DELETE]
> * /stores [GET, POST, PATCH, DELETE]
> * /services [GET, POST, PATCH, DELETE]
> * /categories [GET, POST, PATCH, DELETE]
> * /version [GET]
> * /healthcheck [GET]

* Return all items without Filters
    * Status Code is 200
    * JSON Schema is valid
    * Item Data is available
    * Default limit is correct
    * Default skip is correct
    
* Fetch all items - limit output and skip check for pagination
    * Status Code is 200
    * JSON Schema is valid
    * Item Data is available
    * Returned values of limit and skips are correct
    
* Create a new item
    * Status code is 201
    * Item JSON schema is valid
    * Response contains ID
    
* Create item and edit it based on ID
    * Status code is 200
    * Returns the edited value
    * Item JSON schema is valid
    
* Delete an existing item based on ID
    * Status code is 200
    * Returns the deleted values
    * Item JSON schema is valid
    * Return 404 after searching for the item with ID
    
* Fetch API can be used for different filtering, sorting, querying
    * Status code is 200
    * Returns the expected result
    * Item JSON schema is valid
  
### Specific tests for "/version" and "/healthcheck" endpoints
* Returns the current version of the API Playground being run
    * Status code is 200
    * Returns the version on test

* Returns healthcheck information about the system
    * Status code is 200

## Getting Started

#### Run Best Buy API Playground
```
git clone https://github.com/bestbuy/api-playground/
cd api-playground
npm install
npm start
# Best Buy API Playground started at http://localhost:3030
```
#### Clone the repo
```
git clone https://github.com/oritro76/aritra-banerjee.git
```

#### Create vitual environment for the project
```commandline
virtualenv venv
```
#### Activate the virtual environment
Windows
```commandline
venv\Scripts\activate
```
Linux
```commandline
source venv/bin/activate
```
#### Install requirements

```commandline
pip install -r requirements.txt
```

#### Run tests
Run only Smoke tests

```
pytest -m smoketest --alluredir=./test_results
```

Run only End-to-End tests

```
pytest -m endtoendtest --alluredir=./test_results
```

Run all tests
```
pytest --alluredir=./test_results
```

See Test Reports
```
allure serve ./test_results
```
